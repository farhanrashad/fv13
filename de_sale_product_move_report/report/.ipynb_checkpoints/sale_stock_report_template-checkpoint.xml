<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="de_sale_stock_pdf_report">
        <t t-call="web.html_container">
            <t t-call="web.internal_layout">
                <div class="page">
                    <h2 class="text-center">Stock Report</h2>
                    <hr/>
                    <h4 class="text-center">As on <span t-esc="data['date']" t-options="{'widget': 'date'}" /></h4>
                    <h4 class="text-center">on <span t-esc="data['location']" /> for <span t-esc="data['sale']" /></h4>
                    <div class="row mt32">        
                    </div>
                </div>
                <t t-set="tot_quantity" t-value="0"/>
                <t t-set="tot_weight" t-value="0"/>

                <table t-if="data['group_by_report']=='lot' " class="table table-striped table-bordered" name="account_lines_table">
                    <thead class="thead-dark">
                        <tr class="table-active">
                            <th>Product</th>
                            <th>Lot #</th>
                            <th>Quantity In Hand</th>
                            <th>Weight In Hand</th>
                            <th>Location</th>
                        </tr>
                    </thead>
                    <tbody>
                       <tr t-foreach="dat" t-as="d" style="border-bottom:1px solid #000;">
                           <t t-set="tot_quantity" t-value="tot_quantity+d['quantity']"/>
                           <t t-set="tot_weight" t-value="tot_weight+d['product_weight']"/>
                           <td><span t-esc="d['product_name']"/></td>
                           <td><span t-esc="d['lot']"/></td>
                            <td class="text-right"><t t-esc="'{0:,.2f}'.format(float(d['quantity']))" /> <span t-esc="d['uom']"/></td>
                            <td class="text-right"><t t-esc="'{0:,.2f}'.format(float(d['product_weight']))" /> Kg</td> 
                           <td><span t-esc="d['location']"/></td>
                        </tr>
                        <tr>
                            <td colspan="2"><strong>Total</strong></td>
                            <td class="text-right"><strong><t t-esc="round(tot_quantity,2)" /></strong></td>
                            <td class="text-right"><strong><t t-esc="round(tot_weight,2)" /></strong></td>                            
                        </tr>

                    </tbody>
                  </table>
                
                <t t-set="tot_quantity" t-value="0"/>
                <t t-set="tot_weight" t-value="0"/>
                
                <table t-if="data['group_by_report']=='product' " class="table table-striped table-bordered" name="account_lines_table">
                    <thead class="thead-dark">
                        <tr class="table-active">
                            <th>Product</th>
                            <th>Quantity In Hand</th>
                            <th>Weight In Hand</th>
                            <th>Location</th>
                        </tr>
                    </thead>
                    <tbody>
                       <tr t-foreach="dat1" t-as="d" style="border-bottom:1px solid #000;">
                           <t t-set="tot_quantity" t-value="tot_quantity+d['quantity']"/>
                           <t t-set="tot_weight" t-value="tot_weight+d['product_weight']"/>
                           <td><span t-esc="d['product_name']"/></td>
                            <td class="text-right"><t t-esc="'{0:,.2f}'.format(float(d['quantity']))" /> <span t-esc="d['uom']"/></td>
                            <td class="text-right"><t t-esc="'{0:,.2f}'.format(float(d['product_weight']))" /> Kg</td>
                           <td><span t-esc="d['location']"/></td>
                        </tr>
                        <tr>
                            <td colspan="1"><strong>Total</strong></td>
                            <td class="text-right"><strong><t t-esc="round(tot_quantity,2)" /></strong></td>
                            <td class="text-right"><strong><t t-esc="round(tot_weight,2)" /></strong></td>
                            <td/>
                        </tr>

                    </tbody>
                  </table>
                
                <t t-set="tot_quantity" t-value="0"/>
                <t t-set="tot_weight" t-value="0"/>
                
                <table t-if="data['group_by_report']=='category' " class="table table-striped table-bordered" name="account_lines_table">
                    <thead class="thead-dark">
                        <tr class="table-active">
                            <th>Product Category</th>
                            <th>Quantity In Hand</th>
                            <th>Weight In Hand</th>
                            <th>Location</th>
                        </tr>
                    </thead>
                    <tbody>
                       <tr t-foreach="dat2" t-as="d" style="border-bottom:1px solid #000;">
                           <t t-set="tot_quantity" t-value="tot_quantity+d['quantity']"/>
                           <t t-set="tot_weight" t-value="tot_weight+d['product_weight']"/>
                           <td><span t-esc="d['product_category']"/></td>
                            <td class="text-right"><t t-esc="'{0:,.2f}'.format(float(d['quantity']))" /> <span t-esc="d['uom']"/></td>
                            <td class="text-right"><t t-esc="'{0:,.2f}'.format(float(d['product_weight']))" /> Kg</td>
                           <td><span t-esc="d['location']"/></td>
                        </tr>
                        <tr>
                            <td colspan="1"><strong>Total</strong></td>
                            <td class="text-right"><strong><t t-esc="round(tot_quantity,2)" /></strong></td>
                            <td class="text-right"><strong><t t-esc="round(tot_weight,2)" /></strong></td>
                            <td/>
                        </tr>

                    </tbody>
                  </table>
                
                
            </t>
        </t>
    </template>
</odoo>